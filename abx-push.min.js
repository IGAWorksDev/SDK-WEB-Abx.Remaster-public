"use strict";(self.webpackChunkadbrix_remaster_web_sdk=self.webpackChunkadbrix_remaster_web_sdk||[]).push([[902],{6078:(e,t,n)=>{n.d(t,{g:()=>a});var i=n(4575),r=n.n(i),s=n(3913),o=n.n(s),a=function(){function e(){r()(this,e)}return o()(e,null,[{key:"isSupportedServiceWorker",value:function(){return void 0!==window.navigator.serviceWorker}},{key:"isSupportedPushAPI",value:function(){return void 0!==window.PushSubscription&&void 0!==window.PushSubscriptionOptions}}]),e}()},3227:(e,t,n)=>{n.d(t,{e:()=>c});var i=n(4575),r=n.n(i),s=n(3913),o=n.n(s),a=n(4084),c=function(){function e(){r()(this,e)}return o()(e,null,[{key:"checkValidation",value:function(e){var t=e.webPushConfig;this.checkSameSiteURL(t.setup.site_url),this.checkPushConfig(t),this.checkAPNSPush(e),this.checkIOSDevice(e.browserEnvironment)}},{key:"checkSameSiteURL",value:function(e){var t=new a.k(e).getOrigin();if(window.location.origin!==t)throw Error("Please check your site url in push setup")}},{key:"checkPushConfig",value:function(e){if(!e)throw Error("Please check your push setup")}},{key:"checkAPNSPush",value:function(e){if(e.pushEnvironment.isSafariPush&&!e.webPushConfig.safari_web_id)throw Error("Please check your safari push setup (APNS Certificate)")}},{key:"checkIOSDevice",value:function(e){if("iOS"===e.os)throw Error("Push is not supported in iOS")}}]),e}()},9549:(e,t,n)=>{n.d(t,{f:()=>a});var i=n(4575),r=n.n(i),s=n(3913),o=n.n(s),a=function(){function e(){r()(this,e)}return o()(e,null,[{key:"getButtonStyle",value:function(e,t){var n=t.text_color,i=t.bg_color,r=t.border_color,s=t.border_radius,o=t.hover,a="";return e.classList.forEach((function(e){a="".concat(a,".").concat(e)})),"\n      ".concat(a," {\n        color: ").concat(n,";\n        background-color: ").concat(i,";\n        border-color: ").concat(r,";\n        border-radius: ").concat(s,"px;\n      }\n      ").concat(o.enabled?"\n      ".concat(a,":hover {\n        color: ").concat(o.text_color,";\n        background-color: ").concat(o.bg_color,";\n        border-color: ").concat(o.border_color,"px;\n      }\n      "):"","\n    ")}}]),e}()},8682:(e,t,n)=>{n.d(t,{Y:()=>p});var i=n(7757),r=n.n(i),s=n(8926),o=n.n(s),a=n(4575),c=n.n(a),u=n(3913),h=n.n(u),p=function(){function e(){c()(this,e)}var t;return h()(e,null,[{key:"getServiceWorkerRegistration",value:function(e){return navigator.serviceWorker.getRegistration(e)}},{key:"registerServiceWorker",value:function(e,t){return navigator.serviceWorker.register(e,{scope:t})}},{key:"unregisterServiceWorker",value:(t=o()(r().mark((function e(t,n){var i;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getServiceWorkerRegistration("".concat(t,"/").concat(n));case 2:if(!(i=e.sent)){e.next=6;break}return i.unregister(),e.abrupt("return",!0);case 6:return e.abrupt("return",!1);case 7:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"getAvailableServiceWorker",value:function(e){return e.installing||e.waiting||e.active}}]),e}()},6984:(e,t,n)=>{n.r(t),n.d(t,{AdbrixPush:()=>I});var i=n(7757),r=n.n(i),s=n(8926),o=n.n(s),a=n(4575),c=n.n(a),u=n(3913),h=n.n(u),p=n(9713),d=n.n(p),f=n(5058),l=n(5028),v=n(6258),b=n(3227),m=n(7679),g=n(5889),P=n(383),k=n(8667),w=n(9702),y=n(965),x=n(3698),S=n(2364);function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){d()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var I=function(){function e(){c()(this,e)}var t,n,i,s,a,u;return h()(e,null,[{key:"init",value:(u=o()(r().mark((function e(t,n,i){var s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.adbrixSdk=i,this.appLandingMetaInfo=t,e.prev=2,e.next=5,this.fetchWebPushConfig(this.appLandingMetaInfo.appkey);case 5:return s=e.sent,this.webPushConfig=this.getMergedWebPushConfig(s,n),this.context=new l.q(this.webPushConfig,w.n.host,this.adbrixSdk,i.getAbxCore().getIndexedDb()),b.e.checkValidation(this.context),e.next=11,this.context.indexedDB.setWebPushConfig(this.webPushConfig);case 11:return e.next=13,this.internalInit();case 13:this.setPublicPushAPI(),this.isInitialized=!0,document.dispatchEvent(new Event("pushInitialized")),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(2),this.adbrixSdk.abxOptions.trace.error("Failed to initialize push context. ".concat(e.t0.message));case 21:case"end":return e.stop()}}),e,this,[[2,18]])}))),function(e,t,n){return u.apply(this,arguments)})},{key:"getMergedWebPushConfig",value:function(e,t){if(e.push_type===g.j.direct){var n,i=JSON.parse(JSON.stringify(e));return i.direct.service_worker=C(C(C({},{file_name:"sw.js",file_path:"/",scope:"/"}),e.direct.service_worker),t.serviceWorkerOptions),i.custom_prompt.zIndex=(null===(n=t.subscriptionPromptOptions)||void 0===n?void 0:n.zIndex)||99999999,i}return e}},{key:"internalInit",value:(a=o()(r().mark((function e(){var t,n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.context.pushEnvironment.isDirectPush){e.next=9;break}return e.next=4,this.saveDirectPushSettings();case 4:return this.startWorkerMessenger(),e.next=7,this.sendOpenPushEventWithUnscopedServiceWorker();case 7:e.next=12;break;case 9:t=new P.I(this.context),n=t.appendIframe(),this.startProxyIframeMessenger(n);case 12:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"onInitialized",value:function(e){var t="function"==typeof e;this.isInitialized?t&&e():document.addEventListener("pushInitialized",(function(){t&&e()}),{once:!0})}},{key:"onWindowLoaded",value:function(e){var t="function"==typeof e;"complete"===document.readyState?t&&e():window.addEventListener("load",(function(){t&&e()}),{once:!0})}},{key:"initDirectPushEnvironment",value:(s=o()(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.context.pushEnvironment.isSupportedPushAPI){e.next=3;break}return e.next=3,this.registerServiceWorker();case 3:return e.next=5,this.subscribePush();case 5:return e.next=7,this.saveDirectPushSettings();case 7:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"startSubscribeWindowMessenger",value:function(e){var t=this,n=new y.P(e,this.webPushConfig.indirect.proxy_url);n.listen(),n.postMessage({type:k.C.subscribeWindowConnected,data:{webPushConfig:this.webPushConfig}}),n.on(k.C.subscribeWindowInitialized,(function(e){var n=e.subscriptionId,i=e.enablePush;t.context.storeManager.save({subscriptionId:n,enablePush:i})}))}},{key:"saveDirectPushSettings",value:(i=o()(r().mark((function e(){var t,n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.context.subscriptionManager.getSerializedSubscriptionModel();case 2:t=e.sent,n=this.context.permissionManager.getNotificationPermissionBoolean(),this.context.storeManager.save({subscriptionId:t,enablePush:n});case 5:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"fetchWebPushConfig",value:function(e){return fetch("".concat("https://static.adbrix.io/web-sdk/apps/","push/").concat((0,m.m)(e),".json"),{cache:"no-cache",method:"get"}).then((function(e){if(e.status===f.oj.NOT_FOUND)throw Error("Web Push Setting is required!");return e.json()})).catch((function(e){throw e}))}},{key:"registerServiceWorker",value:(n=o()(r().mark((function e(){var t;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.context.serviceWorkerManager,e.next=3,t.isRegistrationRequired();case 3:if(!e.sent){e.next=6;break}return e.next=6,t.register();case 6:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"subscribePush",value:function(){return this.context.subscriptionManager.subscribe()}},{key:"setPublicPushAPI",value:function(){this.adbrixSdk.setPublicPushAPI({isPushEnabled:this.isPushEnabled.bind(this),isPushSupported:this.isPushSupported.bind(this),showPrompt:this.showPrompt.bind(this),showNativePrompt:this.showNativePrompt.bind(this),showLocalNotification:this.showLocalNotification.bind(this),getNotificationPermission:this.getNotificationPermission.bind(this)})}},{key:"isPushEnabled",value:function(){var e=this;return new Promise((function(t){e.onInitialized((function(){t(e.context.storeManager.getEnablePush()&&!!e.context.storeManager.getSubscriptionId())}))}))}},{key:"isPushSupported",value:function(){var e=this;return new Promise((function(t){e.onInitialized((function(){t(e.context.pushEnvironment.isSupportedPushAPI||e.context.browserEnvironment.isSafari)}))}))}},{key:"showPrompt",value:function(){var e=this;return new Promise((function(t){e.onInitialized(o()(r().mark((function n(){return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:t(e.context.promptManager.showPrompt());case 1:case"end":return n.stop()}}),n)}))))}))}},{key:"showNativePrompt",value:function(){var e=this;return new Promise((function(t){e.onInitialized((function(){e.context.pushEnvironment.isDirectPush?t(e.context.permissionManager.requestPermission()):t(e.showPrompt())}))}))}},{key:"getNotificationPermission",value:function(){var e=this;return new Promise((function(t){e.onInitialized((function(){e.context.pushEnvironment.isDirectPush?t(e.context.permissionManager.getNotificationPermission()):t(e.context.storeManager.getEnablePush()?v.O.granted:v.O.denied)}))}))}},{key:"showLocalNotification",value:function(e,t){var n=this;return new Promise((function(i){n.onInitialized((function(){var r=new S.V(n.webPushConfig,{title:e,options:t});i(r.showNotification())}))}))}},{key:"startWorkerMessenger",value:function(){var e=this,t=new x.z(this.context.webPushConfig.direct.service_worker);t.listen(),t.postMessage({type:k._.handsake}),t.on(k._.openPush,(function(t){var n=t.openPushPayload;e.sendOpenPushEvent(n)}))}},{key:"sendOpenPushEventWithUnscopedServiceWorker",value:(t=o()(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=this,e.next=3,this.context.indexedDB.getOpenPushPayload();case 3:e.t1=e.sent,e.t0.sendOpenPushEvent.call(e.t0,e.t1);case 5:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"startProxyIframeMessenger",value:function(e){var t=this,n=new y.P(e.contentWindow,this.webPushConfig.indirect.proxy_url);n.listen(),n.postMessage({type:k.C.proxyIframeConnected,data:{webPushConfig:this.webPushConfig}}),n.on(k.C.proxyIframeInitialized,(function(e){var n=e.subscriptionId,i=e.enablePush,r=e.openPushPayload;t.context.storeManager.save({enablePush:i,subscriptionId:n}),t.sendOpenPushEvent(r)}))}},{key:"sendOpenPushEvent",value:function(e){if(e){var t=e.clickTimeMillisecond;if(!t||Date.now()-t<1e4){var n={"abx:gf:campaign_id":e["abx:gf:campaign_id"],"abx:gf:campaign_revision_no":e["abx:gf:campaign_revision_no"],"abx:gf:step_id":e["abx:gf:step_id"],"abx:gf:cycle_time":e["abx:gf:cycle_time"]};this.adbrixSdk.getAbxCore().sendEvent("open_push",n,!0)}this.context.indexedDB.deleteOpenPushPayload()}}}]),e}();d()(I,"isInitialized",!1)},1726:(e,t,n)=>{n.d(t,{Y:()=>l});var i=n(7757),r=n.n(i),s=n(8926),o=n.n(s),a=n(4575),c=n.n(a),u=n(3913),h=n.n(u),p=n(6078),d=n(6258),f=n(5058),l=function(){function e(t){c()(this,e),this.context=t,this.safariSubscribeUrl="".concat(this.context.webPushConfig.region===f.Fh.ap1?"https://ap1.event.dfinery.io":"https://ap2.event.dfinery.io","/api")}var t;return h()(e,[{key:"getSafariPermissionData",value:function(){return window.safari.pushNotification.permission(this.safariWebId)}},{key:"getSafariDeviceToken",value:function(){return this.getSafariPermissionData().deviceToken}},{key:"getNotificationPermission",value:function(){return p.g.isSupportedPushAPI()?Notification.permission:this.isSafari?this.getSafariPermissionData().permission:d.O.default}},{key:"getNotificationPermissionBoolean",value:function(){return this.getNotificationPermission()===d.O.granted}},{key:"requestPermission",value:(t=o()(r().mark((function e(){var t;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=this.getNotificationPermission())===d.O.default){e.next=3;break}return e.abrupt("return",t);case 3:if(!p.g.isSupportedPushAPI()){e.next=9;break}return e.next=6,Notification.requestPermission();case 6:t=e.sent,e.next=13;break;case 9:if(!this.isSafari){e.next=13;break}return e.next=12,this.requestSafariPermission();case 12:t=e.sent;case 13:return e.abrupt("return",t);case 14:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"requestSafariPermission",value:function(){var e=this;return new Promise((function(t,n){try{var i={appkey:e.context.webPushConfig.appkey};window.safari.pushNotification.requestPermission(e.safariSubscribeUrl,e.safariWebId,i,(function(e){t(e.permission)}))}catch(e){n(e)}}))}},{key:"safariWebId",get:function(){return this.context.webPushConfig.safari_web_id}},{key:"isSafari",get:function(){return this.context.browserEnvironment.isSafari}}]),e}()},8727:(e,t,n)=>{n.d(t,{C:()=>b});var i=n(7757),r=n.n(i),s=n(8926),o=n.n(s),a=n(4575),c=n.n(a),u=n(3913),h=n.n(u),p=n(6258),d=n(6984),f=n(8667),l=n(4003),v=n(9549),b=function(){function e(t){c()(this,e),this.context=t,this.$customPrompt=this.createCustomPrompt(),this.$customPromptPermissionInform=this.$customPrompt.querySelector(".prompt-container__browser-permission-inform"),this.$customPromptPermissionInformCloseBtn=this.$customPrompt.querySelector(".browser-permission-inform__close-button"),this.registerClickEventHandlers()}var t;return h()(e,[{key:"createCustomPrompt",value:function(){var e=document.createElement("div");e.setAttribute("id","dfinery-noti-permission-prompt"),e.setAttribute("style","display:none !important"),e.className="dfinery-noti-permission-prompt",e.insertAdjacentHTML("afterbegin",this.getPromptElements());var t=document.createElement("style");t.innerHTML=this.getCustomPromptStyle();var n=l.Z.getUserLanguageContent(this.context.webPushConfig.custom_prompt.prompt);this.setCustomPromptContents(e,n),this.$customPromptAllowBtn=e.querySelector(".prompt-container__body-ok-button"),this.$customPromptAllowBtn.textContent=n.allow_button.text,this.$customPromptCancelBtn=e.querySelector(".prompt-container__body-cancel-button"),this.$customPromptCancelBtn.textContent=n.cancel_button.text;var i=document.createElement("style");return i.innerHTML=this.getCustomPromptButtonStyle(n),d.AdbrixPush.onWindowLoaded((function(){document.head.appendChild(t),document.head.appendChild(i),document.body.appendChild(e)})),e}},{key:"showPrompt",value:(t=o()(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.shouldShowPrompt&&(this.closePermissionInform(),this.$customPrompt.setAttribute("style","display:flex !important"));case 1:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"closePrompt",value:function(){this.$customPrompt.setAttribute("style","display:none !important")}},{key:"permissionPromptIframeMessageEventHandler",value:function(){this.context.pushEnvironment.isDirectPush?(this.context.permissionManager.getNotificationPermission()!==p.O.denied&&this.closePrompt(),this.executeDirectPushNotification()):(this.executeIndirectPushNotification(),this.closePrompt())}},{key:"executeDirectPushNotification",value:function(){var e=this;this.showNativePrompt().then((function(t){t===p.O.granted?d.AdbrixPush.onInitialized((function(){d.AdbrixPush.initDirectPushEnvironment()})):t===p.O.denied&&e.showPermissionInform()}))}},{key:"executeIndirectPushNotification",value:function(){this.subscribeWindowMessageHandler&&window.removeEventListener("message",this.subscribeWindowMessageHandler);var e=window.open(this.subscribeWindowUrl,"_blank","'scrollbars=yes, width=".concat(560,", height=",470,", top=20, left=20"));this.subscribeWindowMessageHandler=function(t){t.data.type===f.C.subscribeWindowReConnected&&d.AdbrixPush.startSubscribeWindowMessenger(e)},window.addEventListener("message",this.subscribeWindowMessageHandler)}},{key:"showNativePrompt",value:function(){return this.context.permissionManager.requestPermission()}},{key:"registerClickEventHandlers",value:function(){var e=this;this.$customPromptAllowBtn.addEventListener("click",(function(){e.permissionPromptIframeMessageEventHandler()})),this.$customPromptCancelBtn.addEventListener("click",(function(){e.closePrompt()})),this.$customPromptPermissionInformCloseBtn.addEventListener("click",(function(){e.closePermissionInform()}))}},{key:"showPermissionInform",value:function(){this.$customPromptPermissionInform.setAttribute("style","display: block")}},{key:"closePermissionInform",value:function(){this.$customPromptPermissionInform.setAttribute("style","display: none")}},{key:"setCustomPromptContents",value:function(e,t){var n=t.title,i=t.desc,r=t.browser_notification_permission_unblock_prompt_message;e.querySelector(".prompt-container__header-title").textContent=n,e.querySelector(".prompt-container__body-contents").textContent=i,e.querySelector(".browser-permission-inform__text").textContent=r}},{key:"getCustomPromptButtonStyle",value:function(e){var t=e.allow_button,n=e.cancel_button,i=v.f.getButtonStyle(this.$customPromptAllowBtn,t),r=v.f.getButtonStyle(this.$customPromptCancelBtn,n);return"".concat(i," ").concat(r)}},{key:"getCustomPromptStyle",value:function(){return"\n      .dfinery-noti-permission-prompt {\n        position: fixed;\n        left: 50%;\n        top: 5%;\n        transform: translateX(-50%);\n        z-index: ".concat(this.context.webPushConfig.custom_prompt.zIndex," !important;\n        width: 400px;\n        min-height: 160px;\n        padding: 15px;\n        border-radius: 2px;\n        box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.1);\n        border: 1px solid #e9ecef;\n        background-color: #fff;\n        box-sizing: border-box;\n        animation: 0.1s slide-down; \n        color: #495057;\n      }\n      \n      @media (max-width: 560px) {\n        .dfinery-noti-permission-prompt {\n          top: unset;\n          bottom: 0;\n          width: 100%;\n        }\n      }\n\n      @-webkit-keyframes slide-down {\n        0% {\n          -webkit-transform: translate(-50%, -100%);\n          transform: translate(-50%, -100%);\n        }\n  \n        100% {\n          -webkit-transform: translate(-50%, 0);\n          transform: translate(-50%, 0);\n        }\n      }\n  \n      @keyframes slide-down {\n        0% {\n          -webkit-transform: translate(-50%, -100%);\n          transform: translate(-50%, -100%);\n        }\n  \n        100% {\n          -webkit-transform: translate(-50%, 0);\n          transform: translate(-50%, 0);\n        }\n      }\n\n    .dfinery-permission-prompt-container {\n      display: flex;\n      flex-direction: column;\n      justify-content: flex-start;\n      align-items: flex-start;\n      width: 100%;\n    }\n    \n    .prompt-container__browser-permission-inform {\n      display: none;\n      margin: -15px -15px 15px -15px;\n      padding: 15px;\n      border-bottom: 1px solid #e9ecef;\n      background-color: #f8f9fa;\n    }\n    \n    .prompt-container__lock-image {\n      max-width: 100%;\n    }\n    \n    .browser-permission-inform__text {\n      width: calc(100% - 20px);\n      margin-bottom: 10px;\n      font-size: 14px;\n    }\n    \n    .browser-permission-inform__close-button {\n      position: absolute;\n      right: 5px;\n      top: 10px;\n      display: inline-flex;\n      padding: 5px;\n      color: #6c757d;\n      background: unset;\n      border: unset;\n      cursor: pointer;\n    }\n    \n    .browser-permission-inform__close-button:hover,\n    .browser-permission-inform__close-button:focus {\n      color: #495057;\n    }\n\n    .prompt-container__header {\n      display: flex;\n      align-items: center;\n    }\n    \n    .prompt-container__icon-wrapper {\n      display: flex;\n      padding: 4px;\n      margin-right: 10px;\n      border-radius: 3px;\n      background-color: #eec114;\n    }\n\n    .prompt-container__header-title {\n      margin: 0;\n      font-size: 14px;\n      font-weight: 700;\n    }\n\n    .prompt-container__body {\n      flex-grow: 1;\n      margin-top: 15px;\n      font-size: 14px;\n    }\n    \n    .prompt-container__footer {\n      width: 100%;\n      margin-top: 15px;\n    }\n\n    .prompt-container__footer-button-wrapper {\n      display: flex;\n      float: right;\n    }\n\n    .prompt-container__button {\n      white-space: nowrap;\n      background: #000000;\n      border: 1px solid #000000;\n      color: #ffffff;\n      -webkit-appearance: none;\n      text-align: center;\n      box-sizing: border-box;\n      outline: none;\n      margin: 0;\n      transition: .1s;\n      font-weight: 500;\n      -moz-user-select: none;\n      -webkit-user-select: none;\n      -ms-user-select: none;\n      padding: 8px 12px;\n      font-size: 13px;\n      border-radius: 3px;\n      cursor: pointer;\n    }\n\n    .prompt-container__button:hover, .prompt-container__button:focus {\n      color: #409eff;\n      border-color: #c6e2ff;\n      background-color: #ecf5ff;\n    }\n\n    .prompt-container__button + .prompt-container__button {\n      margin-left: 10px;\n    }\n\n    ")}},{key:"getPromptElements",value:function(){return'\n    <div class="dfinery-permission-prompt-container">\n      <div class="prompt-container__browser-permission-inform">\n        <div class="browser-permission-inform__text">브라우저 알림 권한이 차단되어 있습니다. 별도의 알림 설정을 통해 권한을 허용해주세요.</div>\n        <button class="browser-permission-inform__close-button">\n          <svg style="width:20px;height:20px" viewBox="0 0 24 24">\n            <path fill="currentColor" d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" />\n          </svg>\n        </button>\n        <img class="prompt-container__lock-image" src="https://static.adbrix.io/web-sdk/assets/lock.png">\n      </div>\n      <div class="prompt-container__header">\n        <div class="prompt-container__icon-wrapper">\n          <svg style="width:20px;height:20px;color: white" viewBox="0 0 24 24">\n            <path fill="currentColor" d="M10 21H14C14 22.1 13.1 23 12 23S10 22.1 10 21M21 19V20H3V19L5 17V11C5 7.9 7 5.2 10 4.3V4C10 2.9 10.9 2 12 2S14 2.9 14 4V4.3C17 5.2 19 7.9 19 11V17L21 19M17 11C17 8.2 14.8 6 12 6S7 8.2 7 11V18H17V11Z" />\n          </svg>\n        </div>\n        <div class="prompt-container__header-title">푸시 알림 받기</div>\n      </div>\n      <div class="prompt-container__body">\n        <div class="prompt-container__body-contents">지금 푸시 알림을 구독하고 중요한 최신 소식들을 가장 먼저 받아보세요! 🎉</div>\n      </div>\n      <div class="prompt-container__footer">\n        <div class="prompt-container__footer-button-wrapper">\n          <button class="prompt-container__button prompt-container__body-cancel-button">다음에</button>\n          <button class="prompt-container__button button--primary prompt-container__body-ok-button">알림 받기</button>\n        </div>\n      </div>\n    </div>\n    '}},{key:"shouldShowPrompt",get:function(){return!this.context.storeManager.getEnablePush()||!this.context.storeManager.getSubscriptionId()}},{key:"subscribeWindowUrl",get:function(){return"".concat(this.context.webPushConfig.indirect.proxy_url,"/").concat("1.3.2","/subscribe-window.html")}}]),e}()},383:(e,t,n)=>{n.d(t,{I:()=>c});var i=n(4575),r=n.n(i),s=n(3913),o=n.n(s),a=n(6984),c=function(){function e(t){r()(this,e),this.context=t,this.isEnablePush=this.context.storeManager.getEnablePush(),this.subscriptionId=this.context.storeManager.getSubscriptionId()}return o()(e,[{key:"appendIframe",value:function(){var e=this;return this.removeIframe(),this.$iframe=this.createIframe(),a.AdbrixPush.onWindowLoaded((function(){document.body.appendChild(e.$iframe)})),this.$iframe}},{key:"createIframe",value:function(){var e=document.createElement("iframe");return e.style.display="none",e.src=this.iframeUrl,e.sandbox="allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation",e}},{key:"removeIframe",value:function(){this.$iframe&&this.$iframe.remove()}},{key:"iframeUrl",get:function(){return"".concat(this.context.webPushConfig.indirect.proxy_url,"/").concat("1.3.2","/iframe.html")}}]),e}()},5016:(e,t,n)=>{n.d(t,{Z:()=>f});var i=n(7757),r=n.n(i),s=n(8926),o=n.n(s),a=n(4575),c=n.n(a),u=n(3913),h=n.n(u),p=n(8682),d=n(4084),f=function(){function e(t){c()(this,e),this.serviceWorkerConfig=t}var t,n,i;return h()(e,[{key:"getRegistration",value:function(){return p.Y.getServiceWorkerRegistration(this.scopeURL)}},{key:"register",value:function(){return p.Y.registerServiceWorker(this.scriptURL,this.serviceWorkerConfig.scope)}},{key:"unregister",value:function(){return p.Y.unregisterServiceWorker(this.scriptURL,this.serviceWorkerConfig.scope)}},{key:"isRegistered",value:(i=o()(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getRegistration();case 2:return e.t0=e.sent,e.abrupt("return",null!==e.t0);case 4:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"getAvailableServiceWorker",value:(n=o()(r().mark((function e(t){var n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t,e.t0){e.next=5;break}return e.next=4,this.getRegistration();case 4:e.t0=e.sent;case 5:return n=e.t0,e.abrupt("return",n?p.Y.getAvailableServiceWorker(n):null);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"isRegistrationRequired",value:(t=o()(r().mark((function e(){var t,n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getRegistration();case 2:if(!(t=e.sent)){e.next=13;break}if((n=p.Y.getAvailableServiceWorker(t)).scriptURL===this.scriptURL){e.next=7;break}return e.abrupt("return",!0);case 7:if(t.scope===this.scopeURL){e.next=9;break}return e.abrupt("return",!0);case 9:if(new d.k(n.scriptURL).getFileName()===this.serviceWorkerConfig.file_name){e.next=12;break}return e.abrupt("return",!0);case 12:return e.abrupt("return",!1);case 13:return e.abrupt("return",!0);case 14:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"scriptURL",get:function(){return"".concat(location.origin).concat(this.serviceWorkerConfig.file_path).concat(this.serviceWorkerConfig.file_name)}},{key:"scopeURL",get:function(){return"".concat(location.origin).concat(this.serviceWorkerConfig.scope)}}]),e}()},5750:(e,t,n)=>{n.d(t,{e:()=>c});var i=n(4575),r=n.n(i),s=n(3913),o=n.n(s),a=n(4003),c=function(){function e(t){r()(this,e),this.adbrixSdk=t,this.adbrixCore=t.getAbxCore(),this.adbrixCookie=this.adbrixCore.getAbxCookie()}return o()(e,[{key:"getEnablePush",value:function(){return this.adbrixCookie.getEnablePushCookie()}},{key:"getSubscriptionId",value:function(){return this.adbrixCookie.getSubscriptionIdCookie()}},{key:"save",value:function(e){var t=e.enablePush,n=e.subscriptionId,i=this.getEnablePush(),r=this.getSubscriptionId();a.Z.isNil(r)&&a.Z.isNil(n)||i===t&&r===n||(this.adbrixCookie.setEnablePush(t),this.adbrixCookie.setPushSubscriptionId(n),this.adbrixCore.sendEvent("set_push",{},!0))}}]),e}()},2604:(e,t,n)=>{n.d(t,{L:()=>d});var i=n(7757),r=n.n(i),s=n(8926),o=n.n(s),a=n(4575),c=n.n(a),u=n(3913),h=n.n(u),p=n(8776),d=function(){function e(t){c()(this,e),this.context=t}var t,n,i;return h()(e,[{key:"subscribe",value:function(){return this.context.pushEnvironment.isSafariPush?this.subscribeSafariPush():this.subscribeVapidPush()}},{key:"subscribeSafariPush",value:function(){return this.context.permissionManager.requestPermission()}},{key:"subscribeVapidPush",value:(i=o()(r().mark((function e(){var t,n,i,s=this;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getSubscription();case 2:if(t=e.sent){e.next=15;break}return e.next=6,this.getServiceWorkerRegistration();case 6:return n=e.sent,e.next=9,this.context.serviceWorkerManager.getAvailableServiceWorker();case 9:if("activated"!==(i=e.sent).state){e.next=14;break}return e.abrupt("return",n.pushManager.subscribe({applicationServerKey:this.context.webPushConfig.vapid_public_key,userVisibleOnly:!0}));case 14:i.addEventListener("statechange",function(){var e=o()(r().mark((function e(t){var i,o;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("activated"!==(null==t?void 0:t.target).state){e.next=9;break}return e.next=4,n.pushManager.subscribe({applicationServerKey:s.context.webPushConfig.vapid_public_key,userVisibleOnly:!0});case 4:return e.next=6,s.context.subscriptionManager.getSerializedSubscriptionModel();case 6:i=e.sent,o=s.context.permissionManager.getNotificationPermissionBoolean(),s.context.storeManager.save({subscriptionId:i,enablePush:o});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 15:return e.abrupt("return",t);case 16:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"getSubscription",value:(n=o()(r().mark((function e(){var t;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getServiceWorkerRegistration();case 2:if(!(t=e.sent)){e.next=5;break}return e.abrupt("return",t.pushManager.getSubscription());case 5:return e.abrupt("return",null);case 6:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"getServiceWorkerRegistration",value:function(){return this.context.serviceWorkerManager.getRegistration()}},{key:"getSerializedSubscriptionModel",value:(t=o()(r().mark((function e(){var t,n,i;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.context.pushEnvironment.isDirectPush?p.$.direct:p.$.indirect,!this.context.pushEnvironment.isSafariPush){e.next=6;break}if(!(n=this.context.permissionManager.getSafariDeviceToken())){e.next=5;break}return e.abrupt("return",new p.h({pushType:t,deviceToken:n}).getSerializedSubscriptionModel());case 5:case 11:return e.abrupt("return",null);case 6:return e.next=8,this.getSubscription();case 8:if(!(i=e.sent)){e.next=11;break}return e.abrupt("return",new p.h({pushType:t,vapidSubscription:i}).getSerializedSubscriptionModel());case 12:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}()},965:(e,t,n)=>{n.d(t,{P:()=>p});var i=n(4575),r=n.n(i),s=n(3913),o=n.n(s),a=n(9713),c=n.n(a),u=n(4003),h=n(8667),p=function(){function e(t,n){r()(this,e),c()(this,"eventHandler",{}),c()(this,"initialized",!1),this.targetOrigin=n,this.targetWindow=t,this.$event=document.createElement("div")}return o()(e,[{key:"listen",value:function(){this.boundListenerMessageHandler=this.listenerMessageHandler.bind(this),window.addEventListener("message",this.boundListenerMessageHandler)}},{key:"listenerMessageHandler",value:function(e){if(u.Z.isSameURL(e.origin,this.targetOrigin)){var t=e.data;(null==t?void 0:t.type)===h.C.handshake&&(this.port=e.ports[0],this.port.start(),this.port&&(window.removeEventListener("message",this.boundListenerMessageHandler),this.bindListenerPortOnMessageHandler(),this.whenInitialized()))}}},{key:"bindListenerPortOnMessageHandler",value:function(){var e=this;this.port.onmessage=function(t){var n=t.data,i=e.eventHandler[n.type];i&&i(n.data)}}},{key:"connect",value:function(){this.channel=new MessageChannel,this.port=this.channel.port1,this.port.start(),this.bindConnectorPortOnMessageHandler(),this.targetWindow.postMessage({type:h.C.handshake},this.targetOrigin,[this.channel.port2]),this.whenInitialized()}},{key:"bindConnectorPortOnMessageHandler",value:function(){var e=this;this.port.onmessage=function(t){var n=t.data,i=e.eventHandler[n.type];i&&i(n.data)}}},{key:"whenInitialized",value:function(){this.initialized=!0,this.$event.dispatchEvent(new Event("messengerInitialized"))}},{key:"on",value:function(e,t){this.eventHandler[e]=t}},{key:"off",value:function(e){delete this.eventHandler[e]}},{key:"postMessage",value:function(e){var t=this;return new Promise((function(n,i){try{t.initialized?(t.port.postMessage(e),n()):t.$event.addEventListener("messengerInitialized",(function(){t.port.postMessage(e),t.$event=null,n()}))}catch(e){i(e)}}))}}]),e}()},3698:(e,t,n)=>{n.d(t,{z:()=>l});var i=n(7757),r=n.n(i),s=n(8926),o=n.n(s),a=n(4575),c=n.n(a),u=n(3913),h=n.n(u),p=n(9713),d=n.n(p),f=n(5016),l=function(){function e(t){c()(this,e),d()(this,"eventHandler",{}),this.serviceWorkerManager=new f.Z(t),this.isServiceWorker="undefined"!=typeof self&&"undefined"!=typeof ServiceWorkerGlobalScope}var t;return h()(e,[{key:"unicast",value:(t=o()(r().mark((function e(t,n){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isServiceWorker){e.next=5;break}return e.next=3,self.clients.get(t);case 3:e.sent.postMessage(n);case 5:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"postMessage",value:function(e){var t=this;return this.isServiceWorker?null:new Promise((function(e,t){navigator.serviceWorker.ready.then((function(t){e()})),navigator.serviceWorker.addEventListener("activate",o()(r().mark((function t(){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e();case 1:case"end":return t.stop()}}),t)}))))})).then(o()(r().mark((function n(){return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.serviceWorkerManager.getAvailableServiceWorker();case 2:n.sent.postMessage(e);case 4:case"end":return n.stop()}}),n)}))))}},{key:"listen",value:function(){this.isServiceWorker?self.addEventListener("message",this.messageEventHandler.bind(this)):window.navigator.serviceWorker.addEventListener("message",this.messageEventHandler.bind(this))}},{key:"messageEventHandler",value:function(e){var t=e.data,n=this.eventHandler[t.type];n&&n(t.data,e)}},{key:"on",value:function(e,t){this.eventHandler[e]=t}},{key:"off",value:function(e){delete this.eventHandler[e]}}]),e}()},9730:(e,t,n)=>{n.d(t,{o:()=>h});var i,r=n(4575),s=n.n(r),o=n(3913),a=n.n(o),c=n(2238),u=n.n(c);!function(e){e.chrome="Chrome",e.firefox="Firefox",e.safari="Safari",e.edge="Edge",e.internetExplorer="Internet Explorer"}(i||(i={}));var h=function(){function e(){s()(this,e);var t=(new(u().UAParser)).getResult();this.browser=t.browser.name,this.browserVersion=t.browser.version,this.browserMajorVersion=Number(t.browser.version.replace(/[^\d\.]/g,"").split(".")[0]),this.os=t.os.name,this.osVersion=t.os.version,this.deviceType=t.device.type,this.deviceModel=t.device.model,this.deviceVendor=t.device.vendor}return a()(e,[{key:"isSafariVersionUnder16",value:function(){return this.isSafari&&this.browserMajorVersion<16}},{key:"isSafari",get:function(){return this.browser===i.safari}},{key:"isFirefox",get:function(){return this.browser===i.firefox}},{key:"isActiveStatePartitioned",get:function(){return this.isSafari||this.isFirefox}}]),e}()},5028:(e,t,n)=>{n.d(t,{q:()=>m});var i=n(4575),r=n.n(i),s=n(3913),o=n.n(s),a=n(5016),c=n(5889),u=n(1726),h=n(2604),p=n(8727),d=n(9730),f=n(3824),l=n(5750),v=n(1119),b=n(9702),m=function(){function e(t,n,i,s){r()(this,e),this.webPushConfig=t,this.sdkEnvironment=n,this.browserEnvironment=new d.o,this.pushEnvironment=new f.A(t.push_type===c.j.direct,this.browserEnvironment.isSafari),this.subscriptionManager=new h.L(this),this.permissionManager=new u.Y(this),this.indexedDB=s||v.t.getInstance(),this.sdkEnvironment===b.n.host?(this.pushEnvironment.isDirectPush&&(this.serviceWorkerManager=new a.Z(t.direct.service_worker)),this.promptManager=new p.C(this),this.storeManager=new l.e(i)):(this.sdkEnvironment===b.n.proxyIframe||this.sdkEnvironment===b.n.subscriptionWindow)&&(this.serviceWorkerManager=new a.Z({scope:this.indirectServiceWorkerPath,file_path:this.indirectServiceWorkerPath,file_name:this.indirectServiceWorkerFileName}))}return o()(e,[{key:"indirectServiceWorkerPath",get:function(){return"/".concat("1.3.2","/")}},{key:"indirectServiceWorkerFileName",get:function(){return"service-worker.min.js"}}]),e}()},2364:(e,t,n)=>{n.d(t,{V:()=>p});var i=n(9713),r=n.n(i),s=n(4575),o=n.n(s),a=n(3913),c=n.n(a);function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){r()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var p=function(){function e(t,n){o()(this,e),this.notificationConfig=this.createNotificationConfig(t,n)}return c()(e,[{key:"createNotificationConfig",value:function(e,t){return{title:t.title,options:h({badge:e.setup.badge_url,icon:e.setup.icon_url},t.options)}}},{key:"showNotification",value:function(){return new Notification(this.notificationConfig.title,this.notificationConfig.options)}}]),e}()},8667:(e,t,n)=>{var i,r;n.d(t,{C:()=>i,_:()=>r}),function(e){e.handshake="handshake",e.proxyIframeConnected="proxyIframeConnected",e.proxyIframeInitialized="proxyIframeInitialized",e.proxyIframeOpenPush="proxyIframeOpenPush",e.subscribeWindowConnected="subscribeWindowConnected",e.subscribeWindowInitialized="subscribeWindowInitialized",e.subscribeWindowReConnected="subscribeWindowReconnected",e.permissionPromptConnected="permissionPromptConnected",e.permissionPromptConfirmed="permissionPromptConfirmed"}(i||(i={})),function(e){e.handsake="handsake",e.openPush="openPush"}(r||(r={}))},6258:(e,t,n)=>{var i;n.d(t,{O:()=>i}),function(e){e.default="default",e.granted="granted",e.denied="denied"}(i||(i={}))},3824:(e,t,n)=>{n.d(t,{A:()=>u});var i,r=n(4575),s=n.n(r),o=n(3913),a=n.n(o),c=n(6078);!function(e){e.directVAPIDPush="directVAPIDPush",e.directSafariPush="directSafariPush",e.indirectVAPIDPush="indirectVAPIDPush",e.indirectSafariPush="indirectSafariPush"}(i||(i={}));var u=function(){function e(t,n){s()(this,e),this.isDirectPush=t,this.isSafari=n,this.isSupportedPushAPI=c.g.isSupportedServiceWorker()&&c.g.isSupportedPushAPI()}return a()(e,[{key:"getPushEnvironment",value:function(){return this.isDirectVAPIDPush?i.directVAPIDPush:this.isDirectSafariPush?i.directSafariPush:this.isInDirectVAPIDPush?i.indirectVAPIDPush:this.isInDirectSafariPush?i.indirectSafariPush:null}},{key:"isDirectVAPIDPush",get:function(){return this.isDirectPush&&this.isSupportedPushAPI}},{key:"isDirectSafariPush",get:function(){return this.isDirectPush&&!this.isSupportedPushAPI&&this.isSafari}},{key:"isInDirectVAPIDPush",get:function(){return!this.isDirectPush&&this.isSupportedPushAPI}},{key:"isInDirectSafariPush",get:function(){return!this.isDirectPush&&!this.isSupportedPushAPI&&this.isSafari}},{key:"isVAPIDPush",get:function(){return this.isDirectVAPIDPush||this.isInDirectVAPIDPush}},{key:"isSafariPush",get:function(){return this.isDirectSafariPush||this.isInDirectSafariPush}}]),e}()},9702:(e,t,n)=>{var i;n.d(t,{n:()=>i}),function(e){e.host="host",e.proxyIframe="proxyIframe",e.subscriptionWindow="subscriptionWindow"}(i||(i={}))},8776:(e,t,n)=>{n.d(t,{$:()=>i,h:()=>h});var i,r=n(4575),s=n.n(r),o=n(3913),a=n.n(o),c=n(9713),u=n.n(c);!function(e){e[e.direct=0]="direct",e[e.indirect=1]="indirect"}(i||(i={}));var h=function(){function e(t){var n=t.pushType,i=t.vapidSubscription,r=t.deviceToken;s()(this,e),u()(this,"subscriptionModel",this.getDefaultSubscriptionModel());var o=this.subscriptionModel.webPushSubscription;o.webPushType=n,i&&(o.defaultPushSubscription=i.toJSON()),r&&(o.safariPushSubscription={token:r})}return a()(e,[{key:"getDefaultSubscriptionModel",value:function(){return{version:1,webPushSubscription:{webPushType:0,defaultPushSubscription:null,safariPushSubscription:null}}}},{key:"getSerializedSubscriptionModel",value:function(){return JSON.stringify(this.subscriptionModel)}}]),e}()},4084:(e,t,n)=>{n.d(t,{k:()=>a});var i=n(4575),r=n.n(i),s=n(3913),o=n.n(s),a=function(){function e(t){if(r()(this,e),!t)throw Error("URL is empty");this.parsedURL=new URL(t.trim())}return o()(e,[{key:"getWithoutQueryString",value:function(){return"".concat(this.parsedURL.origin).concat(this.parsedURL.pathname)}},{key:"getFileName",value:function(){return this.parsedURL.pathname.split("/").pop()}},{key:"getOrigin",value:function(){return this.parsedURL.origin}},{key:"getHref",value:function(){return this.parsedURL.href}}]),e}()},5889:(e,t,n)=>{var i,r;n.d(t,{j:()=>i}),function(e){e.direct="direct",e.indirect="indirect"}(i||(i={})),function(e){e.open_new_window="open_new_window",e.match_domain_tab="match_domain_tab",e.match_domain_and_path_tab="match_domain_and_path_tab"}(r||(r={}))},4003:(e,t,n)=>{n.d(t,{Z:()=>a});var i=n(4575),r=n.n(i),s=n(3913),o=n.n(s),a=function(){function e(){r()(this,e)}return o()(e,null,[{key:"isSameURL",value:function(e,t){return new URL(e).href===new URL(t).href}},{key:"isSameOrigin",value:function(e,t){return new URL(e).origin===new URL(t).origin}},{key:"isNil",value:function(e){return null==e}},{key:"getUserBrowserLanguage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;return e.navigator.language.split("-")[0].toUpperCase()}},{key:"getUserLanguageContent",value:function(e){var t,n=this.getUserBrowserLanguage(),i=e.default_lang_code,r=e.contents;return(null===(t=r.find((function(e){return e.lang_code===n})))||void 0===t?void 0:t.content)||r.find((function(e){return e.lang_code===i})).content}}]),e}()}}]);